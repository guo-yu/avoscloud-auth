!function(e){"use strict";function s(){var s=this;this.events={},this.on=function(e,s,n){var i=e&&s&&"function"==typeof s;i&&(n&&!this.events[n]&&(this.events[n]={}),n?this.events[n][e]=s:this.events[e]=s)},this.emit=function(e,n,i){return i&&s.events[i]&&s.events[i][e]?s.events[i][e](n):s.events[e]?s.events[e](n):void 0},e.forEach(["signin","signup","signupSms","signinSms","signinViaMobile"],function(n){s[n]||(s[n]={}),s[n].on=function(e,i){return s.on(e,i,n)},e.forEach(["error","success"],function(e){s[n][e]=function(i){return"error"===e&&"string"==typeof i&&(i=new Error(i)),s.emit(e,i,n)}})})}if(!e)throw new Error("avoscloudAuth.init(); angular.js required.");e.module("avoscloud-auth",["avoscloud"]).service("avoscloudAuth",s)}(window.angular,window.debug),function(e,s){"use strict";function n(){var e={};e.signup=['<form id="signupForm" class="signup-form" ng-submit="signup();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">用户名</span>','<input type="text" ng-model="user.username" placeholder="">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">密码</span>','<input type="password" ng-model="user.password" placeholder="********">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">确认密码</span>','<input type="password" ng-model="passwordConfirm" placeholder="********">',"</label>",'<button class="button button-full button-positive" type="submit">注册</button>',"</div>","</form>"].join("\n"),e["signup-sms"]=['<form id="signupForm" class="signup-form" ng-submit="signup();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="">',"</label>",'<label class="item item-input item-stacked-label" ng-show="smsSent">','<span class="input-label">验证码</span>','<input type="text" ng-model="smsCode" placeholder="">',"</label>",'<button class="button button-full button-positive" type="submit">注册</button>','<button class="button button-full" ng-click="resendCode()" ng-bind="resendCodeText" ng-show="smsSent" ng-disabled="resendCodeDisabled"></button>',"</div>","</form>"].join("\n"),e.signin=['<form id="signinForm" class="signin-form" ng-submit="signin();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">用户名</span>','<input type="text" ng-model="user.username" placeholder="">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">密码</span>','<input type="password" ng-model="user.password" placeholder="********">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),e["signin-sms"]=['<form id="signinViaSmsForm" class="signin-form signin-via-sms" ng-submit="signin();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="">',"</label>",'<label class="item item-input item-stacked-label" ng-show="smsSent">','<span class="input-label">验证码</span>','<input type="text" ng-model="smsCode" placeholder="">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),e["signin-via-mobile"]=['<form id="signinViaMobileForm" class="signin-form signin-via-sms" ng-submit="signin();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="">',"</label>",'<label class="item item-input item-stacked-label" ng-show="smsSent">','<span class="input-label">密码</span>','<input type="password" ng-model="password" placeholder="">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),this.create=function(s){return e[s]||"<div></div>"}}if(!e)throw new Error("avoscloudAuth.init(); angular.js required.");var s=s("ionic-form");e.module("avoscloud-auth").service("avoscloud-ionic-form",n)}(window.angular,window.debug),function(e,s){"use strict";function n(e,s,n){function i(n){function i(){return n.user&&n.user.username?n.user.password?void e.login.post(n.user,function(n){return n.sessionToken&&e.headers("session",n.sessionToken),s.signin.success(n)},s.signin.error):s.signin.error("password is required"):s.signin.error("username is required")}n.signin=i}var o={restrict:"AE",template:n.create("signin"),link:i};return o}function i(e,s,n){function i(n){function i(){return n.mobilePhoneNumber?n.smsSent&&!n.smsCode?s.signinSms.error("smsCode is required"):n.smsSent?void e.login.post({mobilePhoneNumber:n.mobilePhoneNumber,smsCode:n.smsCode},function(n){return n.sessionToken&&e.headers("session",n.sessionToken),s.signinSms.success(n)},s.signinSms.error):o(function(){n.smsSent=!0},s.signinSms.error):s.signinSms.error("mobilePhoneNumber is required")}function o(s,i){e.requestLoginSmsCode.post({mobilePhoneNumber:n.mobilePhoneNumber},s,i)}n.signin=i}var o={restrict:"AE",template:n.create("signin-sms"),link:i};return o}function o(e,s,n){function i(n){function i(){return n.mobilePhoneNumber?n.password?void e.login.post({mobilePhoneNumber:n.mobilePhoneNumber,password:n.password},function(n){return n.sessionToken&&e.headers("session",n.sessionToken),s.signinViaMobile.success(n)},s.signinViaMobile.error):s.signinViaMobile.error("password is required"):s.signinViaMobile.error("mobilePhoneNumber is required")}n.signin=i}var o={restrict:"AE",template:n.create("signin-via-mobile"),link:i};return o}if(!e)throw new Error("avoscloudAuth.init(); angular.js required.");var s=s("avoscloud:signin");e.module("avoscloud-auth").directive("avoscloudSignin",["avoscloud","avoscloudAuth","avoscloud-ionic-form",n]).directive("avoscloudSigninSms",["avoscloud","avoscloudAuth","avoscloud-ionic-form",i]).directive("avoscloudSigninMobile",["avoscloud","avoscloudAuth","avoscloud-ionic-form",o])}(window.angular,window.debug),function(e,s){"use strict";function n(e,n,i){function o(i){function o(){if(s(i),!i.user)return n.signup.error("invalid user params");if(!i.user.username)return n.signup.error("invalid username params");if(!i.user.password)return n.signup.error("invalid password params");if(!i.passwordConfirm)return n.signup.error("invalid passwordConfirm params");if(i.user.password!==i.passwordConfirm)return n.signup.error("passwords are not match");var o=new e.users(i.user);o.$save(function(s){return s.sessionToken&&e.headers("session",s.sessionToken),n.signup.success(s)},n.signup.error)}i.signup=o}var t={restrict:"AE",template:i.create("signup"),link:o};return t}function i(e,n,i,o){function t(i){function t(){if(!i.mobilePhoneNumber)return n.signupSms.error("invalid mobilePhoneNumber");if(i.smsSent)return i.smsCode?a():n.signupSms.error("invalid smsCode");i.user={},i.user.username=i.mobilePhoneNumber,i.user.mobilePhoneNumber=i.mobilePhoneNumber,i.user.password=((new Date).getTime()+10*Math.random()).toString();var o=new e.users(i.user);o.$save(function(n){s(n),i.smsSent=!0,r(60),n.sessionToken&&e.headers("session",n.sessionToken)},n.signupSms.error)}function r(e){return 0===e?(i.resendCodeDisabled=!1,void(i.resendCodeText="重发验证短信")):(i.resendCodeDisabled||(i.resendCodeDisabled=!0),i.resendCodeText=e,e--,void o(function(){r(e)},1e3))}function u(){e.requestMobilePhoneVerify.post({mobilePhoneNumber:i.user.mobilePhoneNumber},function(e){s(e),r(60)},function(e){s(e)})}function a(){var s=new e.verifyMobilePhone;s.$save({code:i.smsCode},n.signupSms.success,n.signupSms.error)}i.signup=t,i.resendCode=u}var r={restrict:"AE",template:i.create("signup-sms"),link:t};return r}if(!e)throw new Error("avoscloudAuth.init(); angular.js required.");var s=s("avoscloud:signup");e.module("avoscloud-auth").directive("avoscloudSignup",["avoscloud","avoscloudAuth","avoscloud-ionic-form",n]).directive("avoscloudSignupSms",["avoscloud","avoscloudAuth","avoscloud-ionic-form","$timeout",i])}(window.angular,window.debug);
//# sourceMappingURL=avoscloud-auth.min.js.map