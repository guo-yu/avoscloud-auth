!function(e){"use strict";function s(){var s=this;this.events={},this.on=function(e,s,n){var i=e&&s&&"function"==typeof s;i&&(n&&!this.events[n]&&(this.events[n]={}),n?this.events[n][e]=s:this.events[e]=s)},this.emit=function(e,n,i){return i&&s.events[i]&&s.events[i][e]?s.events[i][e](n):s.events[e]?s.events[e](n):void 0},e.forEach(["signin","signup","signinSms"],function(n){s[n]||(s[n]={}),s[n].on=function(e,i){return s.on(e,i,n)},e.forEach(["error","success"],function(e){s[n][e]=function(i){return"error"===e&&"string"==typeof i&&(i=new Error(i)),s.emit(e,i,n)}})})}function n(e,s){function n(n,i,t,o){function r(){return n.password?n.mobilePhoneNumber?void e.login.get({password:n.password,mobilePhoneNumber:n.mobilePhoneNumber},function(n){return n.sessionToken&&e.headers("session",n.sessionToken),s.signin.success(n)},s.signin.error):s.signin.error("no mobilePhoneNumber"):s.signin.error("no password")}function u(){o.$setViewValue({username:"xxx",password:"xxx"})}n.signin=r,n.updateAccount=u}var i={restrict:"AE",require:"ngModel",template:o("signin"),link:n};return i}function i(e,s){function n(e){function n(){return e.mobilePhoneNumber?e.smsCode?void db.login.get({smsCode:e.smsCode,mobilePhoneNumber:e.mobilePhoneNumber},s.signinSms.success,s.signinSms.error):s.signinSms.error("valid sms code required"):s.signinSms.error("no mobilePhoneNumber")}e.signinViaSms=n}var i={restrict:"AE",require:"ngModel",template:o("signin-sms"),link:n};return i}function t(e,s){function n(n){function i(){if(!n.user)return s.signup.error("invalid user params");if(!n.user.username)return s.signup.error("invalid user params");if(!n.user.password)return s.signup.error("invalid user params");if(!n.passwordConfirm)return s.signup.error("invalid user params");if(n.user.password!==n.passwordConfirm)return s.signup.error("passwords are not match");n.user.mobilePhoneNumber=n.user.username;var i=new e.users(n.user);i.$save(s.signup.success,s.signup.error)}function t(){if(!n.smsCode)return n.alert("请输入短信验证码!");var i=new e.verifyMobilePhone;i.$save({code:n.smsCode},s.signup.success,s.signup.error)}n.signup=i,n.verifyMobilePhone=t}var i={restrict:"AE",require:"ngModel",template:o("signup"),link:n};return i}function o(e){var s={};return s.signin=['<form id="signinForm" class="signin-form" ng-submit="signin();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="137XXXXXXX">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">密码</span>','<input type="password" ng-model="password" placeholder="********">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),s.signup=['<form id="signupForm" class="signup-form" ng-submit="signup();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">密码</span>','<input type="password" ng-model="password" placeholder="********">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),s["signin-sms"]=['<form id="signinViaSmsForm" class="signin-form signin-via-sms" ng-submit="signinViaSms();" novalidate>','<div class="list">','<label class="item item-input item-stacked-label">','<span class="input-label">手机</span>','<input type="text" ng-model="mobilePhoneNumber" placeholder="137XXXXXXX">',"</label>",'<label class="item item-input item-stacked-label">','<span class="input-label">密码</span>','<input type="password" ng-model="password" placeholder="********">',"</label>",'<button class="button button-full button-positive" type="submit">登录</button>',"</div>","</form>"].join("\n"),s[e]}if(!e)throw new Error("avoscloudAuth.init(); angular.js required.");e.module("avoscloud-auth",["avoscloud"]).service("avoscloudAuth",s).directive("avoscloudSignin",["avoscloud","avoscloudAuth",n]).directive("avoscloudSigninSms",["avoscloud","avoscloudAuth",i]).directive("avoscloudSignup",["avoscloud","avoscloudAuth",t])}(window.angular,window.debug);
//# sourceMappingURL=avoscloud-auth.min.js.map